
int validate_flag(char *tid) {
	/* local variable declarations */
	char *auth_env;
	size_t auth_env_len;
	size_t tid_len;
	int ret_val;
	long in_FS_OFFSET;
	int tid_idx = 0;
	int auth_env_idx;
	long tid_sum = 0;
	int flag_start [4];
	int local_48;
	int local_44;
	int local_40;
	int local_3c;
	int local_38;
	int local_34;
	int local_30;
	int local_2c;
	int local_28;
	long local_20;
	
	flag_start[0] = 'S';
	flag_start[1] = 'K';
	flag_start[2] = 'Y';
	flag_start[3] = '-';
	local_48 = 'P';
	local_44 = 'Q';
	local_40 = 'N';
	local_3c = 'O';
	local_38 = '\f'; // filler value
	local_34 = '1';
	local_30 = '0';
	local_2c = '0';
	local_28 = '1';

	auth_env = getenv("AUTH");
	/* make sure the flag was actually read from the environment */
	if (auth_env == (char *)0x0) exit(1);
	auth_env_len = strlen(auth_env);
	/* make sure the environment variable AUTH is a string of length 13 */
	if (auth_env_len != 13) exit(1);

	tid_len = strlen(tid);
	/* calculate the sum of the character values from the tid string */
	while( tid_idx < tid_len ) {
		tid_sum += tid[tid_idx];
		tid_idx++;
	}
	tid_sum %= 10;
	for (auth_env_idx = 0; auth_env_idx <= 12; auth_env_idx++) {
		/* make sure the first four characters match 'SKY-' */
		if (auth_env_idx < 4) {
			if (auth_env[auth_env_idx] != flag_start[auth_env_idx]) {
				exit(1);
			}
		}
		/* make sure the 9th character is the second '-' e.g. SKY-ABC- <-- */
		else if (auth_env_idx == 8) {
			if (auth_env[8] != auth_env[3]) {
				exit(1);
			}
		}
		/* xor the last 8 characters with the calculated tid sum */
		else {
			if ((auth_env[auth_env_idx] ^ tid_sum) != flag_start[auth_env_idx]) {
					exit(1);
			}
		}
	}
	puts("Nope");
										/* WARNING: Subroutine does not return */
	exit(1);
}

